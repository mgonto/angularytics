/**
 * The solution to tracking page views and events in a SPA with AngularJS
 * @version v0.4.0 - 2016-04-15
 * @link https://github.com/mgonto/angularytics
 * @author Martin Gontovnikas <martin@gonto.com.ar>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(){angular.module("angularytics",[]).provider("Angularytics",function(){var a=["Google"];this.setEventHandlers=function(c){angular.isString(c)&&(c=[c]),a=[],angular.forEach(c,function(c){a.push(b(c))})};var b=function(a){return a.charAt(0).toUpperCase()+a.substring(1)},c="$locationChangeSuccess";this.setPageChangeEvent=function(a){c=a};var d=!0;this.disablePageViewTracking=function(){d=!1},this.$get=["$injector","$rootScope","$location",function(b,e,f){var g=[];angular.forEach(a,function(a){g.push(b.get("Angularytics"+a+"Handler"))});var h=function(a){angular.forEach(g,function(b){a(b)})},i={};return i.init=function(){},i.trackEvent=function(a,b,c,d,e){h(function(f){a&&b&&f.trackEvent(a,b,c,d,e)})},i.trackPageView=function(a){h(function(b){a&&b.trackPageView(a)})},i.trackTiming=function(a,b,c,d){h(function(e){a&&b&&c&&e.trackTiming(a,b,c,d)})},d&&e.$on(c,function(){i.trackPageView(f.url())}),i.trackEcommerceTrans=function(a,b,c,d,e,f,g,i,j){h(function(h){a&&h.trackEcommerceTrans(a,b,c,d,e,f,g,i,j)})},i.trackEcommerceItem=function(a,b,c,d,e,f,g){h(function(h){a&&h.trackEcommerceItem(a,b,c,d,e,f,g)})},i.pushTransaction=function(){h(function(a){a.pushTransaction()})},i}]})}(),function(){angular.module("angularytics").factory("AngularyticsConsoleHandler",["$log",function(a){var b={};return b.trackPageView=function(b){a.log("URL visited",b)},b.trackEvent=function(b,c,d,e,f){a.log("Event tracked",b,c,d,e,f)},b.trackTiming=function(b,c,d,e){a.log("Timing tracked",b,c,d,e)},b.trackEcommerceTrans=function(b,c,d,e,f,g,h,i,j){a.log("Transaction tracked",b,c,d,e,f,g,h,i,j)},b.trackEcommerceItem=function(b,c,d,e,f,g,h){a.log("Items tracked",b,c,d,e,f,g,h)},b.pushTransaction=function(){a.log("Transaction pushed","Success!!")},b}])}(),function(){angular.module("angularytics").factory("AngularyticsGoogleHandler",function(){var a={};return a.trackPageView=function(a){_gaq.push(["_set","page",a]),_gaq.push(["_trackPageview",a])},a.trackEvent=function(a,b,c,d,e){_gaq.push(["_trackEvent",a,b,c,d,e])},a.trackTiming=function(a,b,c,d){_gaq.push(["_trackTiming",a,b,c,d])},a.trackEcommerceTrans=function(a,b,c,d,e,f,g,h,i){_gaq.push(["_addTrans",a,b,c,d,e,f,g,h,i])},a.trackEcommerceItem=function(a,b,c,d,e,f,g){_gaq.push(["_addItem",a,b,c,d,e,f,g])},a.pushTransaction=function(){_gaq.push(["_trackTrans"])},a}).factory("AngularyticsGoogleUniversalHandler",function(){var a={};return a.trackPageView=function(a){var b=ga.getAll?ga.getAll():[];angular.forEach(b,function(b){ga(b.get("name")+".set","page",a),ga(b.get("name")+".send","pageview",a)})},a.trackEvent=function(a,b,c,d,e){var f=ga.getAll?ga.getAll():[];angular.forEach(f,function(f){ga(f.get("name")+".send","event",a,b,c,d,{nonInteraction:e})})},a.trackTiming=function(a,b,c,d){var e=ga.getAll?ga.getAll():[];angular.forEach(e,function(e){ga(e.get("name")+".send","timing",a,b,c,d)})},a.trackEcommerceTrans=function(a,b,c,d,e,f,g,h,i){var j=ga.getAll?ga.getAll():[];angular.forEach(j,function(f){ga(f.get("name")+".require","ecommerce"),ga(f.get("name")+".ecommerce:addTransaction",{id:a,affiliation:b,revenue:c,shipping:e,tax:d,currency:i})})},a.trackEcommerceItem=function(a,b,c,d,e,f,g){var h=ga.getAll?ga.getAll():[];angular.forEach(h,function(h){ga(h.get("name")+".require","ecommerce"),ga(h.get("name")+".ecommerce:addItem",{id:a,name:c,sku:b,category:d,price:e,quantity:f,currency:g})})},a.pushTransaction=function(){var a=ga.getAll?ga.getAll():[];angular.forEach(a,function(a){ga(a.get("name")+".ecommerce:send")})},a}).factory("AngularyticsGoogleTagManagerHandler",function(){var a={},b=window.dataLayer=window.dataLayer||[];return a.trackPageView=function(a){b.push({event:"virtualPageview",vpPath:a})},a.trackEvent=function(a,c,d,e,f){b.push({eventCategory:a,eventAction:c,eventLabel:d,eventValue:e,event:"analyticsEvent"})},a})}(),function(){angular.module("angularytics").filter("trackEvent",["Angularytics",function(a){return function(b,c,d,e,f,g){return a.trackEvent(c,d,e,f,g),b}}])}();